<?php	global $_W,$_GPC;	$this->getuserinfo();	$orderno = $_GPC['orderno']; //获取订单的id,,,,,,,,这里的id实际上对应数据库的orderno	$type = $_GPC['type'];	if($type=='confirm'){		pdo_update('tg_order',array('status'=>4),array('orderno'=>$orderno));	}	if(!empty($orderno)){		//从订单信息表里获取数据,存在$order变量里面,前台页面使用了$order['ispaid']、$order['oprice']、$order['orderno']、$order['ctime']等数据		$sql = 'SELECT * FROM '.tablename('tg_order').' WHERE orderno=:orderno  and uniacid = :uniacid'; //从订单信息表里面取得数据的sql语句		$params = array(':orderno'=>$orderno , ':uniacid'=>$_W['uniacid']);		$order = pdo_fetch($sql, $params); //获取符合条件的第一条数据,实际上,符合条件的数据应该有且只有一条		if(empty($order)){			message('获取订单信息失败.'.$id, $this->createMobileUrl('index'));	//如果没有找到符合条件的订单,则返回首页		}		//根据$order['gid']从收货地址表tg_goods获取数据,存在变量good变量里面		$sql = 'SELECT gname,gprice,oprice,gimg,freight FROM '.tablename('tg_goods').' WHERE id=:gid and uniacid = :uniacid'; //从商品信息表里面取得数据的sql语句		$params = array(':gid'=>$order['g_id'], ':uniacid'=>$_W['uniacid']);		$goods = pdo_fetch($sql, $params); //获取符合条件的第一条数据,实际上,符合条件的数据应该有且只有一条		if(empty($goods)){			message('获取商品信息失败', $this->createMobileUrl('index'));	//如果没有找到符合条件的订单,则返回首页		}	}	include $this->template('orderdetails');?>